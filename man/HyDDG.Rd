% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HyDDG.R
\name{HyDDG}
\alias{HyDDG}
\title{Identify Differentially Expressed Genes Using Hypergeometric Distribution}
\usage{
HyDDG(data, group.list, adj.p.method = "BH", BV = 1, ...)
}
\arguments{
\item{data}{A normalized data frame where rows represent probes/genes and columns represent samples.
The data should be in log2 scale.}

\item{group.list}{A character factor vector indicating group information for each column of the \code{data}
data frame. The factor should contain exactly two levels: the first level corresponds to the control
group, and the second level corresponds to the experimental group. The order must match the column
names of \code{data}.}

\item{adj.p.method}{A character string specifying the method for p-value adjustment.
Default is "BH" (Benjamini-Hochberg). Other options include: "holm", "hochberg",
"hommel", "bonferroni", "BH", "BY", "fdr", "none". See \code{\link[stats]{p.adjust}} for details.}

\item{BV}{A numeric value representing the boundary value for fold change determination.
Default is 1. Genes with fold change greater or smaller than this value will
be considered for up- or down-regulation, respectively.}

\item{...}{Additional arguments passed to other internal functions if needed.}
}
\value{
A data frame named \code{HyDDGResult} with the following columns:
\itemize{
\item \code{ID}: Gene or probe IDs corresponding to row names of the input \code{data}.
\item \code{ave.expr}: Average expression value of the gene across all samples.
\item \code{lg.p}: Log-transformed p-values, with a positive sign for up-regulation
and a negative sign for down-regulation.
\item \code{p.value}: The minimum p-value from hypergeometric and binomial tests.
\item \code{p.adj}: Adjusted p-values based on the specified method in \code{adj.p.method}.
\item \code{FC}: Average fold change for each gene, calculated as the mean of fold changes
in experimental samples relative to controls.
\item \code{logFC}: Log2-transformed fold change values.
}
}
\description{
Identifing differentially expressed genes (DEGs) by calculating
up- and down-regulated genes using a Hypergeometric Distribution-based method.
It computes the significance of each gene based on fold change and outputs a
data frame with statistical results.
}
\details{
The function performs the following:
\enumerate{
\item Calls \code{hyfit} to calculate fold changes for experimental samples.
\item For each gene (row), computes the hypergeometric p-values and binomial p-values
for up- and down-regulated genes based on the boundary value (\code{BV}).
\item Identifies the direction of regulation (up or down) and calculates the corresponding
log-transformed p-value (\code{lg.p}).
\item Adjusts p-values using the method specified in \code{adj.p.method}.
\item Recommends genes with \code{abs(lg.p) â‰¥ 3} and \code{FDR < 0.05} as significant.
}
}
\examples{
# Load example data
# BiocManager::install("CLL")
library(CLL)
data("CLLbatch")

# Normalize data using RMA
CLLrma <- rma(CLLbatch)

# Convert normalized data to a data frame
ourData <- as.data.frame(exprs(CLLrma))[c(1:100),]

# Define group information: first 12 columns as control, last 12 as treatment
group <- factor(c(rep("Control", 12), rep("Treat", 12)),
                levels = c("Control", "Treat"))

# Run the HyDDG function
HyDDGResult <- HyDDG(data = ourData, group.list = group)

# Access the result
head(HyDDGResult)

}
